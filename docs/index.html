<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>DataFest</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">DataFest</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./signup.html"> 
<span class="menu-text">Sign Up</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./schedule.html"> 
<span class="menu-text">Schedule</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./workshops.html"> 
<span class="menu-text">Workshops</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./faq.html"> 
<span class="menu-text">FAQ</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./resources.html"> 
<span class="menu-text">Resources</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./sponsors.html"> 
<span class="menu-text">Sponsors</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./coc.html"> 
<span class="menu-text">COC</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./media.html"> 
<span class="menu-text">Media</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./winners.html"> 
<span class="menu-text">Winners</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#event-details" id="toc-event-details" class="nav-link active" data-scroll-target="#event-details">Event details</a></li>
  <li><a href="#what-is-datafest" id="toc-what-is-datafest" class="nav-link" data-scroll-target="#what-is-datafest">What is DataFest?</a></li>
  <li><a href="#testimonials" id="toc-testimonials" class="nav-link" data-scroll-target="#testimonials">Testimonials</a></li>
  <li><a href="#past-datafests-at-duke" id="toc-past-datafests-at-duke" class="nav-link" data-scroll-target="#past-datafests-at-duke">Past DataFests at Duke</a>
  <ul class="collapse">
  <li><a href="#datafest-2023-american-bar-association" id="toc-datafest-2023-american-bar-association" class="nav-link" data-scroll-target="#datafest-2023-american-bar-association">DataFest 2023 – American Bar Association</a></li>
  <li><a href="#datafest-2022---play2prevent-lab-at-yale-school-of-medicine" id="toc-datafest-2022---play2prevent-lab-at-yale-school-of-medicine" class="nav-link" data-scroll-target="#datafest-2022---play2prevent-lab-at-yale-school-of-medicine">DataFest 2022 - Play2Prevent Lab at Yale School of Medicine</a></li>
  <li><a href="#datafest-2021---rocky-mountain-poison-and-drug-safety" id="toc-datafest-2021---rocky-mountain-poison-and-drug-safety" class="nav-link" data-scroll-target="#datafest-2021---rocky-mountain-poison-and-drug-safety">DataFest 2021 - Rocky Mountain Poison and Drug Safety</a></li>
  <li><a href="#datafest-2020---covid-19-virtual-data-challenge" id="toc-datafest-2020---covid-19-virtual-data-challenge" class="nav-link" data-scroll-target="#datafest-2020---covid-19-virtual-data-challenge">DataFest 2020 - COVID-19 Virtual Data Challenge</a></li>
  <li><a href="#datafest-2019---data-source-canadian-national-womens-rugby-team" id="toc-datafest-2019---data-source-canadian-national-womens-rugby-team" class="nav-link" data-scroll-target="#datafest-2019---data-source-canadian-national-womens-rugby-team">DataFest 2019 - Data source: Canadian National Women’s Rugby Team</a></li>
  <li><a href="#datafest-2018---data-source-indeed" id="toc-datafest-2018---data-source-indeed" class="nav-link" data-scroll-target="#datafest-2018---data-source-indeed">DataFest 2018 - Data source: Indeed</a></li>
  <li><a href="#datafest-2017---data-source-expedia" id="toc-datafest-2017---data-source-expedia" class="nav-link" data-scroll-target="#datafest-2017---data-source-expedia">DataFest 2017 - Data source: Expedia</a></li>
  <li><a href="#datafest-2016---data-source-ticketmaster" id="toc-datafest-2016---data-source-ticketmaster" class="nav-link" data-scroll-target="#datafest-2016---data-source-ticketmaster">DataFest 2016 - Data source: Ticketmaster</a></li>
  <li><a href="#datafest-2015---data-source-edmunds.com" id="toc-datafest-2015---data-source-edmunds.com" class="nav-link" data-scroll-target="#datafest-2015---data-source-edmunds.com">DataFest 2015 - Data source: Edmunds.com</a></li>
  <li><a href="#datafest-2014---data-source-gridpoint" id="toc-datafest-2014---data-source-gridpoint" class="nav-link" data-scroll-target="#datafest-2014---data-source-gridpoint">DataFest 2014 - Data source: GridPoint</a></li>
  <li><a href="#datafest-2013---data-source-eharmony" id="toc-datafest-2013---data-source-eharmony" class="nav-link" data-scroll-target="#datafest-2013---data-source-eharmony">DataFest 2013 - Data source: eHarmony</a></li>
  <li><a href="#datafest-2012---data-source-kiva.com" id="toc-datafest-2012---data-source-kiva.com" class="nav-link" data-scroll-target="#datafest-2012---data-source-kiva.com">DataFest 2012 - Data source: Kiva.com</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">DataFest</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="event-details" class="level2">
<h2 class="anchored" data-anchor-id="event-details">Event details</h2>
<p><strong>When:</strong> Friday, March 1 at 5:00pm - Sunday, March 3 at 5:00pm</p>
<p><strong>Where:</strong> Penn Pavilion, Duke University</p>
<p>On Friday we will start with a welcome event where you will be introduced to the surprise data set you’ll be working with other the weekend. You’ll learn more about the data provider and a bit about what they’d like to get out of the data. The data will likely be much more complex than what you are used to seeing in your classes, and you will be given free reign to analyze it however you like. In other words, you will come up with a research question that is of interest to you, and conduct the appropriate analysis to answer your question. But you are welcomed, and encouraged, to take cues from the client’s introduction when shaping your research question(s).</p>
<p>Projects will be due on Sunday afternoon. Each team will give a brief presentation of their findings that will be judged by a panel of judges comprised of faculty and professionals from a variety of fields. There will be prizes in many categories, such as best visualization, best use of external data, and best findings. A finalized list of categories will be announced at the beginning of the competition.</p>
</section>
<section id="what-is-datafest" class="level2">
<h2 class="anchored" data-anchor-id="what-is-datafest">What is DataFest?</h2>
<div class="callout callout-style-simple callout-none no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><a href="./winners.html">Click here</a> to see the 2023 winners! <a href="https://www.youtube.com/watch?v=5oG0UAHRWOk">Click here</a> to watch highlights from a previous DataFest!</p>
</div>
</div>
</div>
<p>ASA DataFest<sup><small>TM</small></sup> is a data analysis competition where teams of up to five students attack a large, complex, and surprise data set over a weekend. Your job is to represent your school by finding and communicating insights into these data. The teams that impress the judges will win prizes as well as glory for their school. Everyone will have a great experience, lots of food, and fun!</p>
<p>ASA DataFest<sup><small>TM</small></sup> is also a great opportunity to gain experience that employers are looking for. Having worked on a data analysis problem at this scale will certainly help make you a good candidate for any position that involves analysis and critical thinking, and it will provide a concrete example to demonstrate your experience during interviews.</p>
<p>ASA DataFest<sup><small>TM</small></sup> at Duke is organized by the Department of Statistical Science and the Statistical Majors Union at Duke University.</p>
</section>
<section id="testimonials" class="level2">
<h2 class="anchored" data-anchor-id="testimonials">Testimonials</h2>
<p>While ASA DataFest<sup><small>TM</small></sup> is a competition, the main goal of the event is to promote collaboration. Here are some testimonials from past participants:</p>
<blockquote class="blockquote">
<p><em>It was a great experience, with a fun and interesting challenge. One of my favorite parts is how varied the presentations and projects from each team are. I love learning about ways in which others looked at and analyzed the same problem/ data.</em></p>
</blockquote>
<blockquote class="blockquote">
<p><em>DataFest was an awesome experience. To me, the best part was working in a team of friends that I usually hung out with, but had not had a chance to work together intensively on a project. We enjoyed analyzing the situations and solving problems together for our client. At the end of the day, we just got to know each other better. It was also fun to interact with other teams to explore other approaches while keeping in mind that we were in competition. The fact that we were given a huge amount of data really challenges us to come up with creative and practical approaches. Another important part was the presentation. Every team had to explain well to the judges their objectives and solutions. Our team won the Best Visualization award which is really awesome. Lastly, the food was fantastic.</em></p>
</blockquote>
</section>
<section id="past-datafests-at-duke" class="level2">
<h2 class="anchored" data-anchor-id="past-datafests-at-duke">Past DataFests at Duke</h2>
<section id="datafest-2023-american-bar-association" class="level3">
<h3 class="anchored" data-anchor-id="datafest-2023-american-bar-association">DataFest 2023 – American Bar Association</h3>
<p><strong>Goal:</strong> Analyze data to provide advice to the American Bar Association on best to ensure the appropriate legal experts are available to support their pro bono legal advice site.</p>
</section>
<section id="datafest-2022---play2prevent-lab-at-yale-school-of-medicine" class="level3">
<h3 class="anchored" data-anchor-id="datafest-2022---play2prevent-lab-at-yale-school-of-medicine">DataFest 2022 - Play2Prevent Lab at Yale School of Medicine</h3>
<p><strong>Goal:</strong> Analyze game logs of the Elm City game to determine if there are coherent styles of play that might be useful for characterizing middle school students’ attitudes towards risky behaviors.</p>
</section>
<section id="datafest-2021---rocky-mountain-poison-and-drug-safety" class="level3">
<h3 class="anchored" data-anchor-id="datafest-2021---rocky-mountain-poison-and-drug-safety">DataFest 2021 - Rocky Mountain Poison and Drug Safety</h3>
<p><strong>Goal:</strong> Use data from surveys conducted in the United States, Canada, Germany, and the United Kingdom to discover and identify patterns of drug use, with particular attention paid to identifying misuse. The analysis results could potentially be used to predict future drug misuse and to inform the development of a questionnaire physicians can use to predict drug misuse.</p>
</section>
<section id="datafest-2020---covid-19-virtual-data-challenge" class="level3">
<h3 class="anchored" data-anchor-id="datafest-2020---covid-19-virtual-data-challenge">DataFest 2020 - COVID-19 Virtual Data Challenge</h3>
<p><strong>Goal:</strong> Explore data to understand a society impact of the COVID-19 pandemic other than its direct health outcomes. What have been the effects on pollution levels, transportation levels, or working from home? Has there been a change in the number of posts on TikTok? What is the impact on online education? The focus is up to you!</p>
</section>
<section id="datafest-2019---data-source-canadian-national-womens-rugby-team" class="level3">
<h3 class="anchored" data-anchor-id="datafest-2019---data-source-canadian-national-womens-rugby-team">DataFest 2019 - Data source: Canadian National Women’s Rugby Team</h3>
<p><strong>Goal:</strong> How do we quantify the role of fatigue and workload in a team’s performance in Rugby 7s? How reliable are the subjective wellness Fata? Should the quality of the opponent or the outcome of the game be considered when examining fatigue during a game? Can widely used measurements of training load and fatigue be improved? How reliable are GPS data in quantifying fatigue?</p>
</section>
<section id="datafest-2018---data-source-indeed" class="level3">
<h3 class="anchored" data-anchor-id="datafest-2018---data-source-indeed">DataFest 2018 - Data source: Indeed</h3>
<p><strong>Goal:</strong> What advice would you give a new high school about what major to choose in college? How does Indeed’s data compare to official government data on the labor market? Can it be used to provide good economic indicators?</p>
</section>
<section id="datafest-2017---data-source-expedia" class="level3">
<h3 class="anchored" data-anchor-id="datafest-2017---data-source-expedia">DataFest 2017 - Data source: Expedia</h3>
<p><strong>Goal:</strong> How do visitors’ searches relate to the choices of hotels booked or not booked? What role do external factors play in hotel choice?</p>
<p>Expedia provided DataFesters with data from search results from millions of visitors around the world who were interested in traveling to destinations all over the world. The data were in two files, one of which included data collected on search results from visitors’ sessions, and another which contained detailed information about the destinations that visitors searched for.</p>
</section>
<section id="datafest-2016---data-source-ticketmaster" class="level3">
<h3 class="anchored" data-anchor-id="datafest-2016---data-source-ticketmaster">DataFest 2016 - Data source: Ticketmaster</h3>
<p><strong>Goal:</strong> How can site visits be converted to ticket sales, and how can TicketMaster identify “true fans” of an artist or band?</p>
<p>Data consisted of three sets. One included events from the last 12 months that tracked customer travel through the website. Another provided information about advertising campaigns on Google, and the third included data on the events themselves.</p>
</section>
<section id="datafest-2015---data-source-edmunds.com" class="level3">
<h3 class="anchored" data-anchor-id="datafest-2015---data-source-edmunds.com">DataFest 2015 - Data source: Edmunds.com</h3>
<p><strong>Goal:</strong> Detect insights into the process of car shopping that can help make the process easier for customers.</p>
<p>Data consist of visitor ‘pathways’ through a website that helps customers configure car features and shop for cars. Five data files were linked by a customer key, and including data about the customer, about his or her visits to the webpage, and, when applicable, about the car purchased and the dealership where the car was purchased.</p>
</section>
<section id="datafest-2014---data-source-gridpoint" class="level3">
<h3 class="anchored" data-anchor-id="datafest-2014---data-source-gridpoint">DataFest 2014 - Data source: GridPoint</h3>
<p><strong>Goal:</strong> Help understand how customers can best save money and energy.</p>
<p>Data consisted of a random sample of customers, with five-minute aggregates over a year of energy consumption that was then aggregated across important features of the commercial properties, as well as supporting climate and location data.</p>
</section>
<section id="datafest-2013---data-source-eharmony" class="level3">
<h3 class="anchored" data-anchor-id="datafest-2013---data-source-eharmony">DataFest 2013 - Data source: eHarmony</h3>
<p><strong>Goal:</strong> Help understand what qualities people look for in prospective dates.</p>
<p>The DataFest students worked with a large sample of prospective matches. For each customer, data were provided on his or her preferences, as well as four matches, their preferences, and information about whether parties contacted one another.</p>
</section>
<section id="datafest-2012---data-source-kiva.com" class="level3">
<h3 class="anchored" data-anchor-id="datafest-2012---data-source-kiva.com">DataFest 2012 - Data source: Kiva.com</h3>
<p><strong>Goal:</strong> Help understand what motivates people to lend money to developing-nation entrepreneurs and what factors are associated with paying these loans.</p>
<p>Several data sets were provided, including characteristics of lenders and borrowers and loan pay-back data.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>